{% extends "base.html" %}
{% block title %}March Madness 2026 - Tournament Bracket Challenge{% endblock %}

{% block content %}
<div class="home-hero">
    <!-- Hero Section -->
    <div class="text-center mb-5 animate__animated animate__fadeIn">
        <h1 class="hero-title">
            <i class="fas fa-basketball"></i>
            MARCH MADNESS
            <span class="year-badge">2026</span>
        </h1>
        <p class="hero-subtitle">The Ultimate Bracket Challenge</p>
        <div class="hero-cta mt-4">
            <a href="{{ url_for('login') }}" class="btn btn-mm-primary btn-lg me-3">
                <i class="fas fa-sign-in-alt me-2"></i>Login to Play
            </a>
            <a href="{{ url_for('leaderboard') }}" class="btn btn-mm-secondary btn-lg">
                <i class="fas fa-trophy me-2"></i>View Leaderboard
            </a>
        </div>
    </div>

    <!-- Live Stats Cards -->
    <div class="row g-4 mb-5 stagger">
        <div class="col-6 col-md-3">
            <div class="stat-card glow-orange">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-value">{{ stats.total_users }}</div>
                <div class="stat-label">Players</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card glow-teal">
                <div class="stat-icon"><i class="fas fa-basketball"></i></div>
                <div class="stat-value">{{ stats.total_games }}</div>
                <div class="stat-label">Games</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card glow-purple">
                <div class="stat-icon"><i class="fas fa-check-double"></i></div>
                <div class="stat-value">{{ stats.total_picks }}</div>
                <div class="stat-label">Total Picks</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                <div class="stat-value">{{ stats.completion_pct }}%</div>
                <div class="stat-label">Complete</div>
            </div>
        </div>
    </div>

    <!-- Current Round Status -->
    {% if current_round %}
    <div class="mm-card mb-5 animate__animated animate__fadeInUp">
        <div class="mm-card-header">
            <i class="fas fa-play-circle"></i>
            Current Round: {{ current_round.short_name }}
        </div>
        <div class="round-progress">
            <div class="progress" style="height: 12px; background: var(--mm-border);">
                {% set progress = (current_round.completed_games_count / current_round.games_count * 100) if current_round.games_count > 0 else 0 %}
                <div class="progress-bar" role="progressbar" style="width: {{ progress }}%; background: var(--mm-gradient-gold);">
                </div>
            </div>
            <div class="d-flex justify-content-between mt-2">
                <span class="text-muted">{{ current_round.completed_games_count }} / {{ current_round.games_count }} games complete</span>
                <span class="badge badge-mm badge-gold">{{ current_round.point_value }} pts per win</span>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Top 3 Leaders -->
    {% if top_users %}
    <div class="mm-card animate__animated animate__fadeInUp" style="animation-delay: 0.3s;">
        <div class="mm-card-header">
            <i class="fas fa-crown"></i>
            Current Leaders
        </div>
        <div class="row g-4">
            {% for user in top_users %}
            <div class="col-md-4">
                <div class="leader-card leader-{{ loop.index }}">
                    <div class="leader-rank">
                        {% if loop.index == 1 %}
                        <i class="fas fa-crown"></i>
                        {% else %}
                        #{{ loop.index }}
                        {% endif %}
                    </div>
                    <div class="leader-avatar">
                        <img src="{{ url_for('static', filename=user.picture) }}"
                             onerror="this.src='https://ui-avatars.com/api/?name={{ user.username }}&background=ff6b35&color=fff'"
                             alt="{{ user.username }}">
                    </div>
                    <div class="leader-name">{{ user.fun_name or user.username }}</div>
                    <div class="leader-username">@{{ user.username }}</div>
                    <div class="leader-points">{{ user.total_points }} pts</div>
                    <div class="leader-accuracy">{{ user.accuracy }}% accuracy</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Tournament Progress -->
    {% if stats.rounds %}
    <div class="mm-card mt-5 animate__animated animate__fadeInUp" style="animation-delay: 0.5s;">
        <div class="mm-card-header">
            <i class="fas fa-sitemap"></i>
            Tournament Progress
        </div>
        <div class="tournament-rounds">
            {% for round in stats.rounds %}
            <div class="round-item {{ 'completed' if round.closed else 'active' if loop.index == 1 else '' }}">
                <div class="round-indicator">
                    {% if round.closed %}
                    <i class="fas fa-check-circle text-success"></i>
                    {% elif round.completed > 0 %}
                    <i class="fas fa-play-circle text-warning"></i>
                    {% else %}
                    <i class="fas fa-circle-notch"></i>
                    {% endif %}
                </div>
                <div class="round-info">
                    <div class="round-name">{{ round.short_name }}</div>
                    <div class="round-games">{{ round.completed }}/{{ round.total_games }} games</div>
                </div>
                <div class="round-points">
                    <span class="badge badge-mm {% if round.closed %}badge-gold{% else %}badge-silver{% endif %}">
                        {{ round.point_value }} pts
                    </span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}

{% block extra_css %}
<style>
    .hero-title {
        font-family: 'Orbitron', monospace;
        font-size: 3.5rem;
        font-weight: 900;
        background: var(--mm-gradient-gold);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: none;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
    }

    .hero-title i {
        -webkit-text-fill-color: var(--mm-primary);
        animation: bounce 2s infinite;
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    .year-badge {
        background: var(--mm-primary);
        -webkit-text-fill-color: #000;
        padding: 5px 20px;
        border-radius: 10px;
        font-size: 2rem;
    }

    .hero-subtitle {
        font-size: 1.5rem;
        color: var(--mm-text-muted);
        margin-top: 1rem;
    }

    .stat-icon {
        font-size: 1.5rem;
        color: var(--mm-primary);
        margin-bottom: 0.5rem;
    }

    /* Leader Cards */
    .leader-card {
        background: var(--mm-dark);
        border-radius: 16px;
        padding: 2rem;
        text-align: center;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .leader-card:hover {
        transform: translateY(-5px);
    }

    .leader-1 {
        border: 2px solid #f5af19;
        box-shadow: 0 0 30px rgba(245, 175, 25, 0.2);
    }

    .leader-1 .leader-rank {
        background: var(--mm-gradient-gold);
        color: #000;
    }

    .leader-1 .leader-rank i {
        color: #000;
    }

    .leader-2 {
        border: 2px solid #bdc3c7;
    }

    .leader-2 .leader-rank {
        background: var(--mm-gradient-silver);
    }

    .leader-3 {
        border: 2px solid #cd7f32;
    }

    .leader-3 .leader-rank {
        background: var(--mm-gradient-bronze);
    }

    .leader-rank {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-family: 'Orbitron', monospace;
    }

    .leader-avatar {
        width: 100px;
        height: 100px;
        margin: 0 auto 1rem;
        border-radius: 50%;
        overflow: hidden;
        border: 3px solid var(--mm-border);
    }

    .leader-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .leader-1 .leader-avatar {
        border-color: #f5af19;
    }

    .leader-name {
        font-weight: 600;
        font-size: 1.1rem;
        margin-bottom: 0.25rem;
    }

    .leader-username {
        color: var(--mm-text-muted);
        font-size: 0.9rem;
        margin-bottom: 0.75rem;
    }

    .leader-points {
        font-family: 'Orbitron', monospace;
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--mm-gradient-gold);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .leader-accuracy {
        color: var(--mm-secondary);
        font-size: 0.85rem;
        margin-top: 0.5rem;
    }

    /* Tournament Rounds */
    .tournament-rounds {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .round-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: var(--mm-dark);
        border-radius: 12px;
        border-left: 4px solid var(--mm-border);
        transition: all 0.3s ease;
    }

    .round-item.completed {
        border-left-color: var(--mm-success);
    }

    .round-item.active {
        border-left-color: var(--mm-primary);
        background: rgba(255, 107, 53, 0.1);
    }

    .round-indicator {
        font-size: 1.5rem;
        width: 40px;
        text-align: center;
    }

    .round-info {
        flex: 1;
    }

    .round-name {
        font-weight: 600;
    }

    .round-games {
        font-size: 0.85rem;
        color: var(--mm-text-muted);
    }

    @media (max-width: 768px) {
        .hero-title {
            font-size: 2rem;
        }

        .year-badge {
            font-size: 1.2rem;
            padding: 3px 12px;
        }

        .hero-subtitle {
            font-size: 1rem;
        }

        .hero-cta .btn {
            display: block;
            width: 100%;
            margin-bottom: 1rem;
        }

        .hero-cta .btn:last-child {
            margin-bottom: 0;
        }
    }
</style>
{% endblock %}
